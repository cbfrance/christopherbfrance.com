<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
  <head>
    <title>The Three Simplest and Most Effective Anti-Spam Hacks I Have Ever Seen</title>
    <meta content='text/html; charset=iso-8859' http-equiv='Content-Type' />
    <meta content=', ' name='keywords' />
    <meta content='The blocklists are just put it right there in that same block in main.cf. I typically use four of them.' name='description' />
    <link href='/assets/css/reset.css' rel='stylesheet' type='text/css' />
    <link href='/assets/css/style.css' media='screen' rel='stylesheet' type='text/css' />
  </head>
  <body>
    <div id='main'>
      <div id='header'>
        <div class='logo'>
          <a href='/'>&laquo; unthinkingly</a>
        </div>
        <div id='nav'>
          <ul>
            <li><a href='/about.html'>about</a></li>
            <li><a href='/archives.html'>archives</a></li>
            <li><a href='/tags.html'>tags</a></li>
            <li>
              <a href='/atom.xml'>rss</a>
            </li>
            <li>
              <a href='/license.html'>license</a>
            </li>
          </ul>
        </div>
      </div>
      <div class='clear'></div>
      <div class='article'>
            <h1>
              The Three Simplest and Most Effective Anti-Spam Hacks I Have Ever Seen
            </h1>
            <div class='meta'>
              <ul class='tags'>
                <li>May 28, 2008</li>
                <li>
                  &middot;
                </li>
                <li>
                  <a href='/posts/2008/5/the/three/simplest/and/most/effective/anti/spam/hacks/i/have/ever/seen.html#disqus_thread'></a>
                </li>
              </ul>
            </div>
            <div class='body'>
              <strong>Hack zero: Switch to Gmail</strong>
              This is not a joke: Gmail is a fantastic and nearly spam-free platform. Notably, you can hook it up with a custom domain name so no one knows you are part of the Goog machine like everyone else.
              
              <strong>Hack one: Greylisting with Postfix on Ubuntu</strong>
              
              <blockquote>A mail transfer agent using greylisting will "temporarily reject" any email from a sender it does not recognize. If the mail is legitimate, the originating server will most likely try again to send it later, at which time the destination will accept it. <span class="attribution"><a href="http://en.wikipedia.org/wiki/Greylisting">Wikipedia: Greylisting</a></span></blockquote>
              
              Assuming that you have your own email server, <a href="http://postgrey.schweikert.ch/">greylisting</a> is genius. <a href="http://en.wikipedia.org/wiki/Greylisting">Diabolically elegant</a>, really. If you run an email server (or any server that can receive email) you are probably running the Postfix MTA, in which case their is a main configuration file appropriately named main.cf. A couple of edits to this file and you are on your way. 
              
              Here's how this setup looks (not my graph but I have definitely seen this happen on production mailservers):
              
              <img src="/wp-content/uploads/mailgraph_greylisting.png" title="spam goes away" /> 
              <span style="clear:both;display:block;"></span>
              
              The really brilliant thing about greylisting is that it it deals with spam way before it ever reaches your inbox, which is the only way to go (I don't use any spam filtering on my mailbox. That's too late, especially from a sysadmin perspective (think of the <strike>children</strike> cycles!).
              
              Step one: install postgrey.
              <code>apt-get install postgrey</code>
              
              Two: edit your main.cf file. 
              <code>sudo vi /etc/postfix/main.cf</code>
              
              Three: Then open it up and look for your smtpd_restrictions; add the following line:
              <code>check_policy_service inet:127.0.0.1:60000 </code>
              
              Four: Reload Postfix
              <code>/etc/init.d/postfix reload</code>
              
              <strong>Hack 2: DNS Blocklists</strong>
              
              This one is even easier, requiring only an extra line (for each blocklist). The blocklists are Just put it right there in that same block in main.cf. I typically use four of them. (Each has a slightly different purpose and tolerance. Check out the sites to get a flavor for why they exist.) This one is actually my favorite -- it was created by the geek premier <a href="http://en.wikipedia.org/wiki/Paul_Vixie">Paul Vixie</a> and uses a <a href="http://en.wikipedia.org/wiki/DNSBL">DNS lookup</a> for an extraordinarily light overhead. 
              
              Step One: 
              
              Open your main.cf file again and add these lines:
              
              <code>  reject_rbl_client list.dsbl.org,&#x000A;  reject_rbl_client sbl.spamhaus.org,&#x000A;  reject_rbl_client cbl.abuseat.org,&#x000A;  reject_rbl_client dul.dnsbl.sorbs.net</code>
              
              Then reboot Postfix: 
              
              <code>/etc/init.d/postfix reload</code>
              
              As with the example above you will also want to watch your mail log to make sure nothings gone wrong. 
              
              <code>sudo tail -f /var/log/maillog</code>
              
              <strong>Hack 3: Keep Spammers out of Your Forms</strong>
              
              This is really the ideal place to stop spam: before it happens. There are a bazillion ways to prove that someone is a human (CAPTCHAs ... sigh), but I think it is instead better to put the burden on the bots. 
              
              Step one: 
              Add a hidden field to your form. 
              
              <code>< textarea name="comment" class="hidden" > </code>
              
               Step two: 
              
              In your handler, ignore anybody that filled out that form (as robots will do). Here's a fragment in php (assumes that the presence of a errors array will prevent submissions):
              
              <code>if (!empty($_REQUEST['comment'])) { $errors[] = "No Spam please."; }</code>
              
              Those are my favorites, let me know if you have any others!
            </div>
          </div>
      <div id='other-articles'>
            <div class='older'>
              <ul>
                <li>
                  <h3>
                    <a href='/posts/2008/5/agile/vs/ixd/pissing/money/away/and/leaving/scar/tissue.html' title='When an architect begins to define a building, he or she works very closely with the people who are buying the building to understand what the requirements are, and translate those requirements into a sketch of a solution.'>
                      &laquo; Agile Engineering vs. Interaction Design: Pissing money away and leaving scar tissue
                    </a>
                  </h3>
                </li>
                <li>
                  <h3>
                    <a href='/posts/2008/5/extreme/programming/vs/interaction/design.html' title="Kent Beck is known as the father of 'extreme programming,' a process created to help developers design and build software that effectively meets user expectations. Alan Cooper is the prime proponent of interaction design, a process with similar goals but different methodology.">
                      &laquo; Extreme Programming vs. Interaction Design
                    </a>
                  </h3>
                </li>
                <li>
                  <h3>
                    <a href='/posts/2008/5/on/the/quality/of/haveing/a/unixlike/interface.html' title='Most importantly, it means that you play well with others, as in the Unix concept of standard out: Whatever your application does, it is able (intended, really) to be used as the input to another application.'>
                      &laquo; On being "unixy"
                    </a>
                  </h3>
                </li>
              </ul>
            </div>
            <div class='newer'>
              <ul>
                <li>
                  <h3>
                    <a href='/posts/2008/5/the/future/is/all/android/all/open/source/and/underpants/and/ice/cream.html' title='Android, (not the just-barely-open iPhone) is the future of mobile development for the masses.'>
                      The Future is All Android, All Open Source. And Underpants. And Ice Cream. &raquo;
                    </a>
                  </h3>
                </li>
                <li>
                  <h3>
                    <a href='/posts/2008/5/books/of/the/month/for/interface/geeks.html' title="It's been a good book month for interface geeks and IXD/UX people. ">
                      Book of the Month Club for Interface & Design Geeks &raquo;
                    </a>
                  </h3>
                </li>
                <li>
                  <h3>
                    <a href='/posts/2008/6/the/unevenly/distributed/future/visualized.html' title='This is really valuable data for thinking about how to influence the adoption of technology'>
                      The Unevenly Distributed Future (of Mobile Application Design), Visualized &raquo;
                    </a>
                  </h3>
                </li>
              </ul>
            </div>
          </div>
      <div class='clear'></div>
      <div class='comments'>
            <div id='disqus_thread'></div>
            <script src='http://disqus.com/forums/nanoc3-blog/embed.js' type='text/javascript'></script>
            <noscript>
              <a href='http://disqus.com/forums/nanoc3-blog/?url=ref'>
                View the discussion thread
              </a>
            </noscript>
          </div>
          <!-- / disqus adds too much visual crap -->
          <style type='text/css'>
            .dsq-dc-logo {
              display: none !important; }
          </style>
      <div class='clear'></div>
    </div>
    <script type='text/javascript'>
          //<![CDATA[
            (function() {
              var links = document.getElementsByTagName('a');
              var query = '?';
              for(var i = 0; i < links.length; i++) {
                if(links[i].href.indexOf('#disqus_thread') >= 0) {
                  query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
                }
              }
              document.write('<script charset="utf-8" type="text/javascript" src="http://disqus.com/forums/nanoc3-blog/get_num_replies.js' + query + '"></' + 'script>');
            })();
          //]]>
        </script>
  </body>
</html>
